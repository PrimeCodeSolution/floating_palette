# FFIgen Configuration for Floating Palette
#
# Generates Dart FFI bindings from src/ffi_interface.h
#
# Usage:
#   dart run ffigen --config ffigen.yaml
#
# After modifying src/ffi_interface.h, run the above command to regenerate bindings.

name: FFIBindings
description: |
  Auto-generated FFI bindings for synchronous native calls.
  Used by SizeReporter, cursor positioning, and screen queries.

output: 'lib/src/ffi/ffi_bindings.g.dart'

headers:
  entry-points:
    - 'src/ffi_interface.h'

# Only include our functions, exclude all system stuff
functions:
  include:
    - 'FloatingPalette_.*'
  rename:
    # FloatingPalette_ResizeWindow -> ResizeWindow
    'FloatingPalette_(.*)': '$1'
  leaf:
    # Generate leaf functions for better performance (no Dart callbacks)
    include:
      - '.*'

# Exclude all macros (system constants)
macros:
  exclude:
    - '.*'

# Exclude all typedefs from system headers
typedefs:
  exclude:
    - '.*'

# Include our glass path structs, exclude all others
# Note: GlassPathBuffer is defined manually in glass_path_bridge.dart
# because ffigen doesn't handle _Atomic types well
structs:
  include:
    - 'GlassPathBuffer'
  exclude:
    - '.*'

# Exclude all unions from system headers
unions:
  exclude:
    - '.*'

# Include our glass path enum, exclude all others
enums:
  include:
    - 'GlassPathCommand'
  exclude:
    - '.*'

# Exclude all unnamed enums
unnamed-enums:
  exclude:
    - '.*'

# Exclude all globals
globals:
  exclude:
    - '.*'

# Add preamble comment
preamble: |
  // AUTO-GENERATED - DO NOT EDIT
  // Generated by ffigen from src/ffi_interface.h
  //
  // To regenerate: dart run ffigen --config ffigen.yaml
  //
  // ignore_for_file: always_specify_types
  // ignore_for_file: camel_case_types
  // ignore_for_file: non_constant_identifier_names

comments:
  style: doxygen
  length: full

# Sort for consistent output
sort: true
